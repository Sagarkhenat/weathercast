<ion-content [fullscreen]="true" class="ion-no-padding">


  <div class="custom-header">
    <div class="header-content">
      <div class="app-title">WeatherCast</div>
    </div>

    <app-weather-search (citySearchEvent)="loadWeather($event)"></app-weather-search>
  </div>

  <!-- Angular if condition to handle loading check-->
  @if (isLoading) {

    <!-- Show a skeleton card to show data will be filled after successful api response-->

    <div class="skeleton-card">
      <div class="skeleton-line title-line"></div>
      <div class="skeleton-circle"></div>
      <div class="skeleton-line temp-line"></div>
      <div class="skeleton-line desc-line"></div>
    </div>

    <div class="skeleton-list">
      @for (item of [1,2,3,4,5]; track $index) {
        <div class="skeleton-row">
          <div class="skeleton-box sm-box"></div>   <div class="skeleton-box md-box"></div>   <div class="skeleton-box lg-box"></div>   </div>
      }
    </div>

  }@else{

    <!-- Show users location data current-->
    @if(weatherData){
      <div class="main-card">
        <div class="city-name">{{ weatherData.name }}</div>

        <div class="temp-container">
            <div class="main-icon">⛅ {{ weatherData.main?.temp }}°C</div>
            <div class="current-temp">
              {{ weatherData.weather[0]?.description | titlecase }}
            </div>
        </div>

      </div>
    }

    <!--show the users location forecast for next 5 days-->
    @if(weatherData && forecastData.length > 0){
        <div class="forecast-section ion-padding-top">
          <div class="list-header">
            <ion-label class="section-title">Weekly Forecast (Midday)</ion-label>
          </div>

          <!-- Forecast wrapper without using ion-list-->
          <div class="forecast-wrapper">
            <ion-grid class="common-list">
              @for (day of forecastData; track $index; let first = $first; let last =$last)  {
                <ion-row class="common-list-item ripple-row"
                  [class.first-forecast-row]="first"
                  [class.last-forecast-row]="last"
                  (click)="openDetails(day)" >

                  <!---Column to show required day-->
                  <ion-col col-3 class="forecast-col">
                      <p class="forecast-day-label">{{ day.dt_txt | date: 'EEE' | uppercase }}</p>
                  </ion-col>

                  <!---Column to show required weather icon-->
                  <ion-col col-2 class="forecast-col">
                    <div style="font-size: 24px; margin-right: 15px;">
                      ⛅
                    </div>
                  </ion-col>

                  <!---Column to show min and max temperature values-->
                  <ion-col col-2 class="forecast-col">
                    <div style="font-size: 13px; color: #666; font-weight: 500;">
                      Max. &nbsp;{{ day.main.temp_max | number: '1.0-0' }}°
                    </div>
                    <div style="font-size: 13px; color: #666;">
                      Min. &nbsp;{{ day.main.temp_min | number: '1.0-0' }}°
                    </div>
                  </ion-col>

                  <!---Column to give description of the forecast-->
                  <ion-col col-5 class="forecast-col">
                    <ion-note style="font-size: 14px; color: #888;">
                      {{ day.weather[0].description | titlecase }}
                    </ion-note>
                  </ion-col>

                </ion-row>
              }

            </ion-grid>
          </div>

        </div>
      }@else{

      }

  }

</ion-content>
